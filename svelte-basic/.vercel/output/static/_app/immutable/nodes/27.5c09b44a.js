import{S as I,i as j,s as q,k as g,q as M,a as N,l as w,m as P,r as O,h as F,c as k,n,b as B,G as p,ad as C,u as D,H as S,I as R}from"../chunks/index.204e011a.js";import{p as z}from"../chunks/stores.9383d868.js";import{p as G}from"../chunks/parse.d12b0d5b.js";import{j as J}from"../chunks/singletons.911e4197.js";import{i as K}from"../chunks/navigation.0945ef98.js";new TextEncoder;const Q=J("apply_action");function V(o){const t=JSON.parse(o);return t.data&&(t.data=G(t.data)),t}function W(o,t=()=>{}){const m=async({action:s,result:a,reset:r})=>{a.type==="success"&&(r!==!1&&HTMLFormElement.prototype.reset.call(o),await K()),(location.origin+location.pathname===s.origin+s.pathname||a.type==="redirect"||a.type==="error")&&Q(a)};async function d(s){var y,v,f;s.preventDefault();const a=new URL((y=s.submitter)!=null&&y.hasAttribute("formaction")?s.submitter.formAction:HTMLFormElement.prototype.cloneNode.call(o).action),r=new FormData(o),b=(v=s.submitter)==null?void 0:v.getAttribute("name");b&&r.append(b,((f=s.submitter)==null?void 0:f.getAttribute("value"))??"");const h=new AbortController;let i=!1;const T=await t({action:a,cancel:()=>i=!0,controller:h,data:r,form:o,submitter:s.submitter})??m;if(i)return;let c;try{const l=await fetch(a,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:r,signal:h.signal});c=V(await l.text()),c.type==="error"&&(c.status=l.status)}catch(l){if((l==null?void 0:l.name)==="AbortError")return;c={type:"error",error:l}}T({action:a,data:r,form:o,update:l=>m({action:a,result:c,reset:l==null?void 0:l.reset}),result:c})}return HTMLFormElement.prototype.addEventListener.call(o,"submit",d),{destroy(){HTMLFormElement.prototype.removeEventListener.call(o,"submit",d)}}}function X(o){var x;let t,m,d=(((x=o[0])==null?void 0:x.message)||"")+"",s,a,r,b,h,i,_,T,c,y,v,f,l,H,U;return{c(){t=g("form"),m=g("p"),s=M(d),a=N(),r=g("input"),h=N(),i=g("input"),T=N(),c=g("button"),y=M("로그인"),v=N(),f=g("button"),l=M("등록"),this.h()},l(u){t=w(u,"FORM",{method:!0,action:!0});var e=P(t);m=w(e,"P",{});var E=P(m);s=O(E,d),E.forEach(F),a=k(e),r=w(e,"INPUT",{type:!0,name:!0,id:!0,class:!0,autocomplete:!0}),h=k(e),i=w(e,"INPUT",{type:!0,name:!0,id:!0,class:!0,autocomplete:!0}),T=k(e),c=w(e,"BUTTON",{type:!0,class:!0});var A=P(c);y=O(A,"로그인"),A.forEach(F),v=k(e),f=w(e,"BUTTON",{formaction:!0,class:!0});var L=P(f);l=O(L,"등록"),L.forEach(F),e.forEach(F),this.h()},h(){var u,e;n(r,"type","text"),n(r,"name","username"),n(r,"id",""),n(r,"class","border p-2"),n(r,"autocomplete","off"),r.value=b=((u=o[0])==null?void 0:u.username)||"",n(i,"type","password"),n(i,"name","password"),n(i,"id",""),n(i,"class","border p-2"),n(i,"autocomplete","off"),i.value=_=((e=o[0])==null?void 0:e.password)||"",n(c,"type","submit"),n(c,"class","border p-2"),n(f,"formaction","?/register"),n(f,"class","border p-2"),n(t,"method","post"),n(t,"action","?/login")},m(u,e){B(u,t,e),p(t,m),p(m,s),p(t,a),p(t,r),p(t,h),p(t,i),p(t,T),p(t,c),p(c,y),p(t,v),p(t,f),p(f,l),H||(U=C(W.call(null,t)),H=!0)},p(u,[e]){var E,A,L;e&1&&d!==(d=(((E=u[0])==null?void 0:E.message)||"")+"")&&D(s,d),e&1&&b!==(b=((A=u[0])==null?void 0:A.username)||"")&&r.value!==b&&(r.value=b),e&1&&_!==(_=((L=u[0])==null?void 0:L.password)||"")&&i.value!==_&&(i.value=_)},i:S,o:S,d(u){u&&F(t),H=!1,U()}}}function Y(o,t,m){let d;R(o,z,a=>m(1,d=a));let{form:s}=t;return d.url.searchParams.get("redirectTo"),o.$$set=a=>{"form"in a&&m(0,s=a.form)},[s]}class rt extends I{constructor(t){super(),j(this,t,Y,X,q,{form:0})}}export{rt as component};
